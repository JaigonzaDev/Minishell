# ðŸŽ¯ FLUJO COMPLETO DE MINISHELL - Desde el Inicio hasta el Final

## ðŸ“‹ VisiÃ³n General

Este documento muestra el flujo completo del programa desde que arranca hasta que termina, incluyendo todas las ramificaciones posibles de forma simplificada.

---

## ðŸš€ FLUJO PRINCIPAL

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         INICIO DEL PROGRAMA                         â”‚
â”‚                              main.c                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
                                 â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Inicializar variables  â”‚
                    â”‚ - env = NULL (ERROR!)  â”‚
                    â”‚ - signals              â”‚
                    â”‚ - exit_status          â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚           BUCLE PRINCIPAL (infinito)            â”‚
        â”‚           while (1)                             â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. LEER ENTRADA                               â”‚
        â”‚     readline("minishell> ")                    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â†’ [Ctrl+D / NULL] â”€â†’ exit(0)
                     â”‚
                     â”œâ”€â”€â†’ [LÃ­nea vacÃ­a] â”€â†’ Volver al inicio del bucle
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. PROCESAR OPERADORES                        â”‚
        â”‚     tokens/operator_split.c                    â”‚
        â”‚     - AÃ±ade espacios alrededor de: | > >> < << â”‚
        â”‚     "ls|cat" â†’ "ls | cat"                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. DIVIDIR EN TOKENS                          â”‚
        â”‚     tokens/split.c - bash_split()              â”‚
        â”‚     - Separa por espacios                      â”‚
        â”‚     - Respeta comillas                         â”‚
        â”‚     "echo 'hola mundo'" â†’ ["echo", "hola mundo"]â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  4. PROCESAR CARACTERES ESPECIALES             â”‚
        â”‚     tokens/quoting.c                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â†’ [Comilla simple '] â”€â†’ TODO literal
                     â”‚    case_squote()
                     â”‚    '$HOME' â†’ $HOME (no expande)
                     â”‚
                     â”œâ”€â”€â†’ [Comilla doble "] â”€â†’ Expande variables
                     â”‚    case_dquote()
                     â”‚    "$HOME" â†’ /home/user
                     â”‚
                     â”œâ”€â”€â†’ [Dollar $] â”€â†’ Expandir variable
                     â”‚    case_dollar()
                     â”‚    expand_dollar/expand_dollar.c
                     â”‚    search_env_var() â†’ busca en env
                     â”‚    $HOME â†’ /home/user
                     â”‚
                     â””â”€â”€â†’ [Escape \] â”€â†’ CarÃ¡cter literal
                          \$HOME â†’ $HOME (no expande)
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  5. ANALIZAR SINTAXIS                          â”‚
        â”‚     commands/parse.c - parse_commands_new()    â”‚
        â”‚     - Clasifica tokens                         â”‚
        â”‚     - Agrupa por comandos                      â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â†’ [Detecta |] â”€â†’ E_PIPE
                     â”œâ”€â”€â†’ [Detecta >] â”€â†’ E_REDIRECT_OUT
                     â”œâ”€â”€â†’ [Detecta >>] â”€â†’ E_REDIRECT_APPEND
                     â”œâ”€â”€â†’ [Detecta <] â”€â†’ E_REDIRECT_IN
                     â”œâ”€â”€â†’ [Detecta <<] â”€â†’ E_REDIRECT_HEREDOC
                     â”œâ”€â”€â†’ [Detecta &&] â”€â†’ E_OPERATOR_AND
                     â”œâ”€â”€â†’ [Detecta ||] â”€â†’ E_OPERATOR_OR
                     â”œâ”€â”€â†’ [Detecta ;] â”€â†’ E_SEPARATOR
                     â”œâ”€â”€â†’ [Primera palabra] â”€â†’ E_COMMAND
                     â””â”€â”€â†’ [Resto] â”€â†’ E_ARG
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  6. VALIDAR SINTAXIS                           â”‚
        â”‚     commands/parse.c                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â†’ [Error sintaxis] â”€â†’ Mensaje error
                     â”‚    "syntax error near unexpected token"
                     â”‚    Volver al inicio del bucle
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  7. DECIDIR TIPO DE EJECUCIÃ“N                  â”‚
        â”‚     pipes/integration.c - bash_execute()       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                     â”‚                                          â”‚
                     â–¼                                          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  COMANDO SIMPLE            â”‚           â”‚  PIPELINE                  â”‚
    â”‚  (sin pipes)               â”‚           â”‚  (con pipes |)             â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                         â”‚
             â”‚                                         â”‚
             â–¼                                         â–¼
    [IR A: EJECUCIÃ“N SIMPLE]              [IR A: EJECUCIÃ“N PIPELINE]
             â”‚                                         â”‚
             â”‚                                         â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                          â”‚
                          â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  8. APLICAR OPERADORES LÃ“GICOS                 â”‚
        â”‚     (si existen && || ;)                       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â”œâ”€â”€â†’ [&&] â”€â†’ Si anterior exitoso (exit=0)
                     â”‚           ejecutar siguiente
                     â”‚           Si falla (exitâ‰ 0) â†’ saltar
                     â”‚
                     â”œâ”€â”€â†’ [||] â”€â†’ Si anterior falla (exitâ‰ 0)
                     â”‚           ejecutar siguiente
                     â”‚           Si exitoso (exit=0) â†’ saltar
                     â”‚
                     â””â”€â”€â†’ [;] â”€â†’ Ejecutar siguiente siempre
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  9. ACTUALIZAR EXIT STATUS                     â”‚
        â”‚     Guardar resultado del comando              â”‚
        â”‚     $? = exit_status                           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  10. LIBERAR MEMORIA                           â”‚
        â”‚      Limpiar tokens, strings temporales        â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â””â”€â”€â†’ Volver al inicio del bucle (paso 1)
```

---

## ðŸ”€ RAMA: EJECUCIÃ“N SIMPLE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              EJECUCIÃ“N COMANDO SIMPLE                       â”‚
â”‚              pipes/integration.c                            â”‚
â”‚              execute_simple_command()                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. CONFIGURAR REDIRECCIONES       â”‚
        â”‚     setup_redirections()           â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”œâ”€â”€â†’ [>] â”€â†’ open(O_WRONLY | O_CREAT | O_TRUNC)
                 â”‚          dup2(fd, STDOUT)
                 â”‚
                 â”œâ”€â”€â†’ [>>] â”€â†’ open(O_WRONLY | O_CREAT | O_APPEND)
                 â”‚           dup2(fd, STDOUT)
                 â”‚
                 â”œâ”€â”€â†’ [<] â”€â†’ open(O_RDONLY)
                 â”‚          dup2(fd, STDIN)
                 â”‚
                 â””â”€â”€â†’ [<<] â”€â†’ ft_read_heredoc()
                            crear pipe temporal
                            escribir contenido en pipe
                            dup2(pipe[0], STDIN)
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. Â¿ES BUILTIN?                   â”‚
        â”‚     builtins/builtins_utils.c      â”‚
        â”‚     is_builtin()                   â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â”œâ”€YESâ”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚       â”‚ EJECUTAR BUILTIN                â”‚
                 â”‚       â”‚ ft_execute_builtin()            â”‚
                 â”‚       â”œâ”€â”€â†’ cd    â†’ builtins/cd.c        â”‚
                 â”‚       â”œâ”€â”€â†’ echo  â†’ builtins/echo.c      â”‚
                 â”‚       â”œâ”€â”€â†’ pwd   â†’ builtins/pwd.c       â”‚
                 â”‚       â”œâ”€â”€â†’ export â†’ builtins/export.c   â”‚
                 â”‚       â”œâ”€â”€â†’ unset â†’ builtins/unset.c     â”‚
                 â”‚       â”œâ”€â”€â†’ env   â†’ builtins/env.c       â”‚
                 â”‚       â”œâ”€â”€â†’ exit  â†’ builtins/exit.c      â”‚
                 â”‚       â””â”€â”€â†’ true/false â†’ builtins/true_false.c
                 â”‚       â”‚
                 â”‚       â–¼
                 â”‚       Retornar exit_status
                 â”‚       â”‚
                 â”‚       â””â”€â”€â†’ [FIN EJECUCIÃ“N SIMPLE]
                 â”‚
                 â”œâ”€NOâ”€â”€â†’ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚       â”‚ COMANDO EXTERNO                 â”‚
                 â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â”‚                â–¼
                 â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚       â”‚ BUSCAR COMANDO                  â”‚
                 â”‚       â”‚ pipes/path_utils.c              â”‚
                 â”‚       â”‚ find_command_in_path()          â”‚
                 â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â”‚                â”œâ”€â”€â†’ [Ruta absoluta] â”€â†’ /bin/ls
                 â”‚                â”‚    Usar directamente
                 â”‚                â”‚
                 â”‚                â”œâ”€â”€â†’ [Buscar en PATH] â”€â†’ ls
                 â”‚                â”‚    env_get_simple("PATH")
                 â”‚                â”‚    split por ":"
                 â”‚                â”‚    probar: /usr/local/bin/ls
                 â”‚                â”‚    probar: /usr/bin/ls âœ“
                 â”‚                â”‚
                 â”‚                â””â”€â”€â†’ [No encontrado] â”€â†’ Error
                 â”‚                     "command not found"
                 â”‚                     exit_status = 127
                 â”‚                â”‚
                 â”‚                â–¼
                 â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚       â”‚ CREAR PROCESO                   â”‚
                 â”‚       â”‚ pid = fork()                    â”‚
                 â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                â”‚
                 â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚         â”‚              â”‚
                 â”‚         â–¼              â–¼
                 â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    â”‚ HIJO    â”‚   â”‚ PADRE    â”‚
                 â”‚    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
                 â”‚         â”‚             â”‚
                 â”‚         â–¼             â–¼
                 â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚    â”‚ execve(cmd, args,   â”‚
                 â”‚    â”‚        envp)        â”‚
                 â”‚    â”‚ - Reemplaza proceso â”‚
                 â”‚    â”‚ - Ejecuta comando   â”‚
                 â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                     â”‚
                 â”‚                     â–¼
                 â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚              â”‚ waitpid(pid) â”‚
                 â”‚              â”‚ Espera hijo  â”‚
                 â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                     â”‚
                 â”‚                     â–¼
                 â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                 â”‚              â”‚ Capturar exit    â”‚
                 â”‚              â”‚ WIFEXITED()      â”‚
                 â”‚              â”‚ WEXITSTATUS()    â”‚
                 â”‚              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚                     â”‚
                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                            [FIN EJECUCIÃ“N SIMPLE]
```

---

## ðŸ”€ RAMA: EJECUCIÃ“N PIPELINE

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   EJECUCIÃ“N PIPELINE                        â”‚
â”‚                   pipes/integration.c                       â”‚
â”‚                   execute_pipeline()                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  1. CONTAR PIPES                   â”‚
        â”‚     count_pipes()                  â”‚
        â”‚     "ls | grep | wc" â†’ 2 pipes     â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  2. CREAR PIPES                    â”‚
        â”‚     pipes/pipes_bonus.c            â”‚
        â”‚     Para N comandos:               â”‚
        â”‚     crear (N-1) pipes              â”‚
        â”‚     int pipes[N-1][2]              â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  3. CREAR PROCESOS (para cada cmd) â”‚
        â”‚     execute_multiple_pipes()       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  PARA CADA COMANDO (i = 0 to N-1):         â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚  fork() â†’ Crear proceso hijo       â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”
          â”‚             â”‚
          â–¼             â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  HIJO    â”‚   â”‚  PADRE     â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚              â”‚
         â–¼              â””â”€â”€â†’ (continÃºa creando hijos)
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CONFIGURAR PIPES:             â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€â”€â†’ [NO es primer comando] â”€â†’ dup2(pipes[i-1][0], STDIN)
         â”‚                               Lee del pipe anterior
         â”‚
         â”œâ”€â”€â†’ [NO es Ãºltimo comando] â”€â†’ dup2(pipes[i][1], STDOUT)
         â”‚                               Escribe al pipe siguiente
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CERRAR TODOS LOS PIPES        â”‚
    â”‚  close(pipes[j][0])            â”‚
    â”‚  close(pipes[j][1])            â”‚
    â”‚  (para todos los pipes)        â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  CONFIGURAR REDIRECCIONES      â”‚
    â”‚  setup_redirections()          â”‚
    â”‚  (si hay > >> < <<)            â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  Â¿ES BUILTIN?                  â”‚
    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”œâ”€YESâ”€â†’ ft_execute_builtin()
         â”‚       exit(exit_status)
         â”‚
         â”œâ”€NOâ”€â”€â†’ find_command_in_path()
         â”‚       execve(cmd, args, envp)
         â”‚
         â–¼
    [Proceso hijo termina]
                 â”‚
                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  PADRE: Esperar todos          â”‚
            â”‚  for (i = 0; i < N; i++)       â”‚
            â”‚     waitpid(pids[i])           â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  CERRAR TODOS LOS PIPES        â”‚
            â”‚  close(pipes[j][0])            â”‚
            â”‚  close(pipes[j][1])            â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  CAPTURAR EXIT DEL ÃšLTIMO CMD  â”‚
            â”‚  exit_status = WEXITSTATUS()   â”‚
            â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                 â”‚
                 â–¼
            [FIN EJECUCIÃ“N PIPELINE]
```

---

## ðŸŽ¯ EJEMPLO COMPLETO PASO A PASO

### Entrada: `echo $HOME | cat > output.txt`

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 1: LEER                                       â”‚
â”‚  readline() â†’ "echo $HOME | cat > output.txt"       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 2: AÃ‘ADIR ESPACIOS A OPERADORES              â”‚
â”‚  operator_split() â†’ "echo $HOME | cat > output.txt" â”‚
â”‚  (ya tiene espacios correctos)                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 3: TOKENIZAR                                  â”‚
â”‚  bash_split() â†’ ["echo", "$HOME", "|", "cat",       â”‚
â”‚                  ">", "output.txt"]                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 4: EXPANDIR VARIABLES                         â”‚
â”‚  case_dollar() â†’ search_env_var("HOME")             â”‚
â”‚  "$HOME" â†’ "/home/carlos"                           â”‚
â”‚  ["echo", "/home/carlos", "|", "cat",               â”‚
â”‚   ">", "output.txt"]                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 5: PARSE                                      â”‚
â”‚  - "echo": E_COMMAND (grupo 0)                      â”‚
â”‚  - "/home/carlos": E_ARG (grupo 0)                  â”‚
â”‚  - "|": E_PIPE                                      â”‚
â”‚  - "cat": E_COMMAND (grupo 1)                       â”‚
â”‚  - ">": E_REDIRECT_OUT (grupo 1)                    â”‚
â”‚  - "output.txt": E_FILE (grupo 1)                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 6: DETECTAR PIPELINE                          â”‚
â”‚  count_pipes() = 1                                  â”‚
â”‚  â†’ execute_multiple_pipes()                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PASO 7: CREAR PIPE                                 â”‚
â”‚  int fd[2];                                         â”‚
â”‚  pipe(fd); // fd[0]=lectura, fd[1]=escritura        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â†“
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â†“                                 â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PROCESO 1       â”‚            â”‚  PROCESO 2       â”‚
â”‚  (grupo 0)       â”‚            â”‚  (grupo 1)       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  fork()          â”‚            â”‚  fork()          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                               â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HIJO 1:         â”‚            â”‚  HIJO 2:         â”‚
â”‚                  â”‚            â”‚                  â”‚
â”‚  dup2(fd[1],     â”‚            â”‚  dup2(fd[0],     â”‚
â”‚       STDOUT)    â”‚   PIPE     â”‚       STDIN)     â”‚
â”‚  close(fd[0])    â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â†’  â”‚  close(fd[1])    â”‚
â”‚  close(fd[1])    â”‚            â”‚  close(fd[0])    â”‚
â”‚                  â”‚            â”‚                  â”‚
â”‚  NO builtin      â”‚            â”‚  NO builtin      â”‚
â”‚  find: /bin/echo â”‚            â”‚  find: /bin/cat  â”‚
â”‚                  â”‚            â”‚                  â”‚
â”‚  execve("/bin/   â”‚            â”‚  fd_out = open(  â”‚
â”‚    echo",        â”‚            â”‚    "output.txt", â”‚
â”‚    ["echo",      â”‚            â”‚    O_WRONLY |    â”‚
â”‚     "/home/      â”‚            â”‚    O_CREAT |     â”‚
â”‚     carlos"])    â”‚            â”‚    O_TRUNC)      â”‚
â”‚                  â”‚            â”‚  dup2(fd_out,    â”‚
â”‚  Escribe:        â”‚            â”‚       STDOUT)    â”‚
â”‚  "/home/carlos\n"â”‚            â”‚                  â”‚
â”‚  â†’ al pipe       â”‚            â”‚  execve("/bin/   â”‚
â”‚                  â”‚            â”‚    cat", ["cat"])â”‚
â”‚                  â”‚            â”‚                  â”‚
â”‚                  â”‚            â”‚  Lee del pipe    â”‚
â”‚                  â”‚            â”‚  Escribe a file  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â†“                               â†“
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  PADRE:               â”‚
         â”‚  close(fd[0])         â”‚
         â”‚  close(fd[1])         â”‚
         â”‚  waitpid(pid1)        â”‚
         â”‚  waitpid(pid2)        â”‚
         â”‚  exit_status = 0      â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  RESULTADO:           â”‚
         â”‚  output.txt creado    â”‚
         â”‚  con: /home/carlos    â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â†“
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  Liberar memoria      â”‚
         â”‚  Volver al prompt     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ðŸ“Š TABLA DE DECISIONES

### Â¿QuÃ© ejecutar?

| CondiciÃ³n | AcciÃ³n |
|-----------|--------|
| Es builtin + NO hay pipes | Ejecutar directamente (sin fork) |
| Es builtin + HAY pipes | fork() + ejecutar + exit() |
| Es comando externo | fork() + find_command + execve() |

### Â¿CuÃ¡ndo usar fork()?

| SituaciÃ³n | fork() |
|-----------|--------|
| Builtin sin pipes (cd, export, unset, exit) | âŒ NO |
| Builtin con pipes (echo \| cat) | âœ… SÃ |
| Comando externo | âœ… SÃ |

### Operadores lÃ³gicos:

| Operador | CondiciÃ³n | Ejecuta siguiente |
|----------|-----------|-------------------|
| `&&` | exit_status == 0 | âœ… SÃ |
| `&&` | exit_status != 0 | âŒ NO |
| `\|\|` | exit_status == 0 | âŒ NO |
| `\|\|` | exit_status != 0 | âœ… SÃ |
| `;` | Cualquiera | âœ… SÃ |

---

## ðŸ”„ CASOS ESPECIALES

### 1. Ctrl+C (SIGINT)

```
Usuario presiona Ctrl+C
    â†“
signals/config.c - signal_handler()
    â†“
Si estÃ¡ esperando input:
    - Cancelar readline
    - Nueva lÃ­nea
    - Mostrar nuevo prompt
    â†“
Si estÃ¡ ejecutando comando:
    - kill(pid, SIGINT)
    - Matar proceso hijo
    - Padre continÃºa
```

### 2. Ctrl+D (EOF)

```
readline() retorna NULL
    â†“
main.c detecta NULL
    â†“
Imprimir "exit"
    â†“
Liberar memoria
    â†“
exit(exit_status)
```

### 3. Comando no encontrado

```
find_command_in_path() retorna NULL
    â†“
Imprimir: "command not found"
    â†“
exit_status = 127
    â†“
Continuar (NO salir del programa)
```

### 4. Error de sintaxis

```
parse detecta error:
- Pipe al inicio: "| ls"
- Pipe al final: "ls |"
- Redirect sin archivo: "ls >"
    â†“
Imprimir: "syntax error near unexpected token"
    â†“
exit_status = 2
    â†“
NO ejecutar comando
    â†“
Volver al prompt
```

### 5. Heredoc (<<)

```
Detecta "<<"
    â†“
ft_read_heredoc(delimiter)
    â†“
while (lÃ­nea != delimiter):
    readline()
    guardar en buffer
    â†“
pipe(heredoc_pipe)
    â†“
write(heredoc_pipe[1], buffer)
    â†“
close(heredoc_pipe[1])
    â†“
dup2(heredoc_pipe[0], STDIN)
    â†“
Ejecutar comando
```

---

## ðŸŽ¯ RESUMEN FINAL

```
INICIO â†’ LOOP â†’ LEER â†’ PROCESAR â†’ EXPANDIR â†’ PARSEAR
                  â†‘                              â†“
                  â”‚                        VALIDAR
                  â”‚                              â†“
                  â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚                    â†“                   â†“
                  â”‚              COMANDO SIMPLE      PIPELINE
                  â”‚                    â†“                   â†“
                  â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                  â”‚              â”‚ BUILTIN â”‚         â”‚ N PIPES â”‚
                  â”‚              â”‚    o    â”‚         â”‚ N+1 PROCâ”‚
                  â”‚              â”‚ EXTERNO â”‚         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
                  â”‚              â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜              â”‚
                  â”‚                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚                              â†“
                  â”‚                        APLICAR && || ;
                  â”‚                              â†“
                  â”‚                        ACTUALIZAR $?
                  â”‚                              â†“
                  â”‚                        LIBERAR MEMORIA
                  â”‚                              â†“
                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Archivos principales por fase:**

1. **Input**: `main.c` (readline)
2. **TokenizaciÃ³n**: `tokens/operator_split.c`, `tokens/split.c`
3. **ExpansiÃ³n**: `tokens/quoting.c`, `expand_dollar/expand_dollar.c`
4. **Parsing**: `commands/parse.c`
5. **EjecuciÃ³n simple**: `pipes/integration.c` (execute_simple_command)
6. **EjecuciÃ³n pipeline**: `pipes/pipes_bonus.c` (execute_multiple_pipes)
7. **Builtins**: `builtins/*.c`
8. **PATH**: `pipes/path_utils.c`
9. **Redirecciones**: `pipes/integration.c` (setup_redirections)
10. **Heredoc**: `pipes/utils_bonus.c` (ft_read_heredoc)
11. **SeÃ±ales**: `signals/config.c`
12. **Environment**: `environment/*.c`

---

## âœ… PUNTOS CLAVE

1. **TODO es un bucle infinito** - Solo sale con exit o Ctrl+D
2. **TokenizaciÃ³n antes de expansiÃ³n** - Primero divide, luego expande
3. **Parse clasifica todo** - Cada token tiene un tipo
4. **Pipes = mÃºltiples procesos** - Uno por cada comando
5. **Builtins sin pipes no hacen fork** - Se ejecutan en el proceso padre
6. **Redirecciones van antes de execve** - dup2() antes de ejecutar
7. **Exit status es clave** - Controla && y ||
8. **Memoria se libera cada iteraciÃ³n** - Evita memory leaks

